<!DOCTYPE html>

<html lang="he" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>page 1</title>
    <link id="pagestyle" rel="stylesheet" href="css/styles.css" type="text/css" />
    <script src="js/jquery-3.2.1.min.js" charset="utf-8"></script>
    <script src="js/scripts.js" charset="utf-8"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sharer.js@latest/sharer.min.js"></script>
    <script>
        
       function loadLang() {
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function () {
        if (this.readyState === 4 && this.status === 200) {
            var myObj = JSON.parse(this.responseText);
            var pickLang = localStorage.getItem("langID");
            if (typeof pickLang !== 'undefined' && pickLang !== null) {
                console.log('load lang, lang id is: ' + pickLang);
                if (pickLang.localeCompare("he") === 0) {
                    localStorage.setItem("langID", "he");
                    $('#lang').css("background-image", "url('cut/Group 128.png')");
                    localStorage.setItem("lang", JSON.stringify(myObj.HE));
                } else {
                    localStorage.setItem("langID", "en");
                    $('#lang').css("background-image", "url('cut/Group 312.png')");
                    localStorage.setItem("lang", JSON.stringify(myObj.EN));
                }
            } else {
                localStorage.setItem("langID", "he");
                localStorage.setItem("lang", JSON.stringify(myObj.HE));
            }
            loadAndFill();
        }
    };
    xmlhttp.open("GET", "js/lang.json", true);
    xmlhttp.send();
  }


        function pickLanguage() {
            var pickLang = localStorage.getItem("langID");
            if (typeof pickLang !== 'undefined' && pickLang !== null) {
                if (pickLang.localeCompare("he") === 0) {
                    pickLang = "en";
                    swapStyleSheet('css/styles-eng.css');
                    localStorage.setItem("langID", "en");
                    loadLang();
                } else if (pickLang.localeCompare("en") === 0) {
                    pickLang = "he";
                    localStorage.setItem("langID", "he");
                    swapStyleSheet('css/styles.css');
                    loadLang();
                }
            } else {
                pickLang = "he";
                localStorage.setItem("langID", "he");
                swapStyleSheet('css/styles.css');
                loadLang();
            }
        }
        function loadCountryInfo(res) {
            if (typeof res !== 'undefined' && res !== null) {
                $('#catgSub1').text(res["name"]);
                $('#catgSub1,#split1').css("display", "inline-block");
                $('#txt1').text(res.timeline[0].info);
                $('#titleTxt2').text(res.timeline[0].timeframe);
                $('#txt2').text(res.timeline[0].info);
                $('#titleTxt3').text(res.timeline[1].timeframe);
                $('#txt3').text(res.timeline[1].info);
            } else {
                $('#catgSub1').text("");            
                $('#txt1').text("");   
                $('#titleTxt2').text("");   
                $('#txt2').text("");   
                $('#titleTxt3').text("");   
                $('#txt3').text("");   
            }
        }

        function loadAndFill() {
            JsonLang = localStorage.getItem("lang");
            var lang = JSON.parse(JsonLang);
            $('#hdTitle').text(lang["hdTitles"]["communities"]);
            $('#catgMain').text(lang.countries)
            $("#close").val(lang.close);
           // var prData = JSON.parse(localStorage.getItem('country'));
            var prData = window.sessionStorage.getItem('country');
            var num = prData;
            val = parseInt(num, 10);
            loadPRData(val);
            
        }

        function loadPRData(searchKey) {
            getCountries().then(value => {
                object = value["data"];
                var langIs = localStorage.getItem('langID'); 
                var result = object.find(obj => {
                    return obj.id === searchKey;
                })
                subObj = getCountry(result["translations"], langIs);
                loadCountryInfo(subObj);
            });
        }

        function getCountry(object, langIs) {   
            var result = object.find(obj => {
                return obj.language.indexOf(langIs) !== -1
            })
            return result;
        }

  
        $(function () {
            pickCSS();
            addModalbox();
            $('body').delegate('#catgMain', 'click', function () {
                location.href = "cj1.html";
            });
           

           
        });
    </script>
</head>

<body>
    <div class="header">
        <div class="headerWrapper">
            <div class="headerCont">
                <div class="langIcon" id="lang"  onclick="pickLanguage()"></div>
                <div class="titleCont"><div class="mainTitle" id="hdTitle">מסע בין קהילות</div></div>
                <div class="homeIcon" onclick="goHomePg()"></div>
            </div>
        </div>
        <div class="borderBtm"></div>
    </div>
    <div class="pageCont">
        <div class="pageWrapper">
            <div class="category">
                <span class="mainCat" id="catgMain" onclick="location.href = 'cj1.html';"></span>
                <span class="split" id="split1">&ensp;/&ensp;</span>
                <span class="subCat" id="catgSub1"></span>
            </div>
            <div class="sharingIcons">
                <span class="shareIcon" id="shareBtn"></span>
                <span class="mailIcon" onclick="mail()"></span>
            </div>

            <div class="pageSubCont">
                <div class="pageSubWrapper">
                    <div class="text" id="txt1">

                    </div>
                    <div class="shapeCont"><div id="img" class="imageShape"></div></div>
                    <div class="text">
                        <div class="textSubTitle" id="titleTxt2"></div>
                        <div id="txt2" class="infoTxt">

                        </div>
                    </div>
                    <div class="text">
                        <div class="textSubTitle" id="titleTxt3"></div>
                        <div id="txt3" class="infoTxt">

                        </div>
                    </div>

                </div>
            </div>
            <div class="modal" id="shareModal">
                <div class="shareModalCont">

                    <div class='txtModal' id="share">
                        <a data-sharer="facebook" data-title="Checkout SJ3!" data-url='' class="fa fa-facebook"></a>
                        <a data-sharer="twitter" data-title="Checkout SJ3!" data-url=''  class="fa fa-twitter"></a>
                        <a data-sharer="linkedin" data-title="Checkout SJ3!" data-url='' class="fa fa-linkedin"></a>
                        <a data-sharer="instagram" data-title="Checkout SJ3!" data-url='' class="fa fa-instagram"></a>
                        <a data-sharer="telegram" data-title="Checkout SJ3!" data-url='' class="fa fa-telegram"></a>
                        <a data-sharer="whatsapp" data-title="Checkout SJ3!" data-url='' class="fa fa-whatsapp"></a>
                    </div>
                    <input class="close" type="button" value="" style="margin-top:240px" id="close"/>
                </div>
            </div>
        </div>
    </div>

</body>
</html>