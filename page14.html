<!DOCTYPE html>

<html lang="he" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>page 14</title>
    <link id="pagestyle" rel="stylesheet" href="css/styles.css" type="text/css" />
    <script src="js/jquery-3.2.1.min.js" charset="utf-8"></script>
    <script src="js/scripts.js" charset="utf-8"></script>

    <script>
        var pickLang = "";
        function parseId(idString) {
            console.log(idString);
            var num = '';
            var z = 0;
            for (i = 0; i < idString.length; i++) {
                if ("" + parseInt(idString[i]) !== "NaN")
                    num = num + idString[i];
            }
            z = parseInt(num);
            return z;
        }

        function pickLanguage() {
            console.log(pickLang);
            if (pickLang.localeCompare("") === 0 || pickLang.localeCompare("he") === 0) {
                pickLang = "en";
                swapStyleSheet('css/styles-eng.css');
                loadLang();
            } else if (pickLang.localeCompare("en") === 0) {
                pickLang = "he";
                swapStyleSheet('css/styles.css');
                loadLang();
            }
        }

        function loadLang() {
           var xmlhttp = new XMLHttpRequest();
           xmlhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                var myObj = JSON.parse(this.responseText);
                
                console.log(myObj);
                if (pickLang.localeCompare("") === 0 || pickLang.localeCompare("he") === 0) {
                    console.log("to hebrew");
                  localStorage.setItem("lang",  JSON.stringify(myObj.HE));
            } else {
                     console.log("to english");
                  localStorage.setItem("lang",  JSON.stringify(myObj.EN));
            }
             }
           };
          xmlhttp.open("GET", "js/lang.json", true);
          xmlhttp.send();
          
        }
        function goToSubCategory(num1, num2,catNum) {
            JsonLang = localStorage.getItem("lang");     
            var lang = JSON.parse(JsonLang);
            console.log("here");
            console.log(lang);
            curr = lang.categories;
            console.log(curr);
            var mainCat = curr[num1];        
            console.log(mainCat);
            var subCat2 = curr[catNum];
            subCat2 = subCat2[num2]
            console.log(subCat2);
            localStorage.setItem("main", mainCat);
            localStorage.setItem("sub", subCat2);
            location.href = "page5.html";
        }

        $(function () {
            loadLang();
            $('.catgItem').click(function () {
                var idItm = this.id;
                var value =  $('#' + idItm)[0].childNodes[0].nodeValue;
                $('#catgMain').addClass('mainCat');
                $('#catgMain').removeClass('greenTitle');
                $('#split').removeClass('invisible');
                $('#catgSub1').html(value);
                var parsedId = parseId(idItm);
                var count = document.getElementById(idItm).childElementCount;
                event.stopPropagation();
                $('#' + idItm).children('.subCat').toggle();
            });

            $('.subCat').click(function () {
                var idItm = this.id;
                var idParent = $(this).parent().attr('id')
                console.log(idParent);
                console.log(idItm);
                var numIs = parseId(idParent);
                var catNum = 's' + numIs;
                goToSubCategory(idParent, idItm, catNum);
            });
        });

    </script>


</head>
<body>
    <div class="header">
        <div class="headerWrapper">
            <div class="headerCont">
                <div class="langIcon" id="lang" onclick="pickLanguage()"></div>
                <div class="titleCont"><div class="mainTitle" id="hdTitle">מסע בין כוכבים</div></div>
                <div class="homeIcon"></div>
            </div>
        </div>
        <div class="borderBtm"></div>
    </div>
    <div class="pageCont">
        <div class="pageWrapper">
            <div class="category">
                <span class="greenTitle" id="catgMain">קטגוריות</span>
                <span class="split invisible" id="split">&ensp;/&ensp;</span>
                <span class="greenTitle" id="catgSub1"></span>
            </div>

            <div class="pageSubCont">
                <div class="pageSubWrapper">
                    <div class="catgList">
                        <ul>
                            <li id="c1" class="catgItem">                              
                                <div id="c1_1" class="subCat"></div>
                                <div id="c1_2" class="subCat"></div>
                                <div id="c1_3" class="subCat"></div>
                                <div id="c1_4" class="subCat"></div>
                            </li>
                            <li id="c2" class="catgItem">
                                
                                <div id="c2_1" class="subCat"></div>
                                <div id="c2_2" class="subCat"></div>
                                <div id="c2_3" class="subCat"></div>
                                <div id="c2_4" class="subCat"></div>
                            </li>
                            <li id="c3" class="catgItem">
                                
                                <div id="c3_1" class="subCat"></div>
                                <div id="c3_2" class="subCat"></div>
                                <div id="c3_3" class="subCat"></div>
                                <div id="c3_4" class="subCat"></div>
                            </li>
                            <li id="c4" class="catgItem">
                                
                                <div id="c4_1" class="subCat"></div>
                                <div id="c4_2" class="subCat"></div>
                                <div id="c4_3" class="subCat"></div>
                                <div id="c4_4" class="subCat"></div>
                            </li>
                            <li id="c5" class="catgItem">
                                
                                <div id="c5_1" class="subCat"></div>
                                <div id="c5_2" class="subCat"></div>
                                <div id="c5_3" class="subCat"></div>
                                <div id="c5_4" class="subCat"></div>
                            </li>
                            <li id="c6" class="catgItem">
                               
                                <div id="c6_1" class="subCat"></div>
                                <div id="c6_2" class="subCat"></div>
                                <div id="c6_3" class="subCat"></div>
                                <div id="c6_4" class="subCat"></div>
                            </li>
                            <li id="c7" class="catgItem">
                                
                                <div id="c7_1" class="subCat"></div>
                                <div id="c7_2" class="subCat"></div>
                                <div id="c7_3" class="subCat"></div>
                                <div id="c7_4" class="subCat"></div>
                            </li>
                            <li id="c8" class="catgItem">
                                
                                <div id="c8_1" class="subCat"></div>
                                <div id="c8_2" class="subCat"></div>
                                <div id="c8_3" class="subCat"></div>
                                <div id="c8_4" class="subCat"></div>
                            </li>
                            <li id="c9" class="catgItem">
                                
                                <div id="c9_1" class="subCat"></div>
                                <div id="c9_2" class="subCat"></div>
                                <div id="c9_3" class="subCat"></div>
                                <div id="c9_4" class="subCat"></div>
                            </li>
                        </ul>
                    </div>
                </div>

            </div>
        </div>
    </div>



</body>
</html>